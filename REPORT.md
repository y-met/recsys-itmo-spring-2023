#### Денис Шибитов, MADE, dshibitov@gmail.com

## 1. Отчет размером в одну страничку:

### 1.1. Abstract: основную идею эксперимента (1 параграф)
За основу взят Contextual рекоммендер, показанный на семинаре. Изменено то, что ищутся рекомендации
не для предыдущего трэка, а для первого трэка пользователя (что логично, так как на семинаре при
подготовке данных для обучения эмбендингов трэков мы делали предположение что первый трэк сильно
характеризует вкусы пользователя). Так же добавлена фильтрация уже прослушенных пользователем трэков,
до тех пор пока это возможно (пока есть ещё не порекомендованные нами). Если они закончились - рекомендуем
первые 15 случайным образом.

### 1.2. Детали: минимум того, что нужно знать, чтобы разобраться в реализации
Особых деталей нет. Для запоминания первого трэка пользователя и уже прослушенных трэков был добавлен кэш
(в нашем учебном примере использовал просто dict).

### 1.3. Результаты A/B эксперимента - в табличке как на семинарах (1 параграф + табличка)
Из эксперимента (1000 episodes) виден положительный значимый эффект на целевую метрику (mean_time_per_session)
![A/B тест](experiment/imgs/1000_episodes.png)

## 2. Ссылка на репозиторий и инструкцию по запуску.
Репозиторий (ветка hw): https://github.com/y-met/recsys-itmo-spring-2023
Запуск контейнера такой же как и на семинаре, никаких новых зависимостей нет.
Запуск симуляции: python sim/run.py --episodes 1000 --config config/env.yml multi --processes 1


PS. На самом деле, задание интересное. Несколько расстроило, что много чего попробовал, но при этом
значимый прирост дали такие простые вещи, а что то что было интересно само по себе не взлетело).
Например пробовал обучать эмбендинги пользователей, так же пробовал обучать различные комбинации их эмбендингов
и эмбендингов трэков. Для этих экспериментов собрал б`ольший набор данных (больше в 3.4 раза).
Кстати говоря, на них эффект от реализованных выше идей выглядит ещё сильнее (сравнивал с переобученным на этих
же (новых) данных Contextual).
![A/B тест](experiment/imgs/dataset2.png)